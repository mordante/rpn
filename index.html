
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>RPN Calculator &#8212; RPN 0.3.0-dev documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Calculations" href="calculation.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
          

          <div class="body" role="main">
            
  <section id="rpn-calculator">
<h1>RPN Calculator<a class="headerlink" href="#rpn-calculator" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#building" id="id5">Building</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id6">Usage</a></p>
<ul>
<li><p><a class="reference internal" href="#gui" id="id7">GUI</a></p></li>
<li><p><a class="reference internal" href="#input-values" id="id8">Input values</a></p></li>
<li><p><a class="reference internal" href="#operations" id="id9">Operations</a></p></li>
<li><p><a class="reference internal" href="#constants" id="id10">Constants</a></p></li>
<li><p><a class="reference internal" href="#functions" id="id11">Functions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#known-limitations" id="id12">Known limitations</a></p>
<ul>
<li><p><a class="reference internal" href="#building-requires-a-git-build-of-clang-and-libc" id="id13">Building requires a git build of Clang and libc++</a></p></li>
<li><p><a class="reference internal" href="#the-gui-isn-t-great" id="id14">The GUI isn’t great</a></p></li>
<li><p><a class="reference internal" href="#the-gui-is-inefficient" id="id15">The GUI is inefficient</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#links" id="id16">Links</a></p></li>
</ul>
</div>
<p>This is yet another
<a class="reference external" href="https://en.wikipedia.org/wiki/Reverse_Polish_notation">RPN</a> calculator. It’s
still in its infancy and the goal of the application is to have better support
for different bases and make it easy to use bitwise operations.</p>
<p>Next to its practical usage the application is used to experiment with:</p>
<blockquote>
<div><ul class="simple">
<li><p>The latest C++ features available in <a class="reference external" href="clang.llvm.org/">Clang</a> and
<a class="reference external" href="libcxx.llvm.org/">libc++</a>.</p></li>
<li><p>The possible CI <a class="footnote-reference brackets" href="#note-cd" id="id1">2</a> features of GitHub actions.</p></li>
</ul>
</div></blockquote>
<p>The sources of the project are at <a class="reference external" href="https://github.com/mordante/rpn">GitHub</a>.</p>
<section id="building">
<h2><a class="toc-backref" href="#id5">Building</a><a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h2>
<p>In order to build the application the following dependencies are required:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://cmake.org/">CMake</a> 3.20.0 or later. Once CMake adds proper module
support the requirement will be incremented to that version.</p></li>
<li><p>A recent <a class="reference external" href="clang.llvm.org/">Clang</a> main build. Clang 15.0.0 is expected to
work, but when module support improves on Clang a more recent build will be
required.</p></li>
<li><p>A recent <a class="reference external" href="libcxx.llvm.org/">libc++</a> main build. In libc++ both <code class="docutils literal notranslate"><span class="pre">&lt;ranges&gt;</span></code>
and <code class="docutils literal notranslate"><span class="pre">&lt;format&gt;</span></code> are actively being developed. When features land in the main
branch the application will use some of these features.</p></li>
<li><p>A working Internet connection. The application depends on
<a class="reference external" href="http://google.github.io/googletest/">GoogleTest</a> and
<a class="reference external" href="https://fltk.org/">FLTK</a>. The proper dependencies are downloaded during
the build process.</p></li>
<li><p>Optional when enabling coverage <code class="docutils literal notranslate"><span class="pre">llvm-cov</span></code> and <code class="docutils literal notranslate"><span class="pre">llvm-profdata</span></code> are
required. This should be the same version as Clang, but normally they are
installed together with Clang.</p></li>
</ul>
<p>The build itself is a normal CMake build. It has the following options:</p>
</section>
<section id="usage">
<h2><a class="toc-backref" href="#id6">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<section id="gui">
<h3><a class="toc-backref" href="#id7">GUI</a><a class="headerlink" href="#gui" title="Permalink to this headline">¶</a></h3>
<p>The application has a simple GUI with the following elements:</p>
<dl class="simple">
<dt>Diagnostics</dt><dd><p>Contains the diagnostics issued by the application. Usually an error message
regarding the last operation.</p>
</dd>
<dt>Stack</dt><dd><p>The stack with the values to operate on.</p>
</dd>
<dt>Input</dt><dd><p>The input buffer where new text is entered.</p>
</dd>
</dl>
<p>At the moment the GUI has no real interaction with the user and can’t be
controlled. All keyboard input is automatically processed by the input buffer.</p>
</section>
<section id="input-values">
<h3><a class="toc-backref" href="#id8">Input values</a><a class="headerlink" href="#input-values" title="Permalink to this headline">¶</a></h3>
<p>Numbers can be entered in the input buffer and put on the stack. A number will
be put on the stack directly when pressing enter. Most operations that work on
stack entries will first put the value of the input buffer on the stack before
applying their operations.</p>
<p>A numeric value may use a digit group separator to improve readability. The
allowed separators are <code class="docutils literal notranslate"><span class="pre">_</span></code> and <code class="docutils literal notranslate"><span class="pre">,`</span></code>.</p>
<p>For example: <code class="docutils literal notranslate"><span class="pre">1_2</span> <span class="pre">1</span></code> and pressing <code class="docutils literal notranslate"><span class="pre">return</span></code> will put the values <code class="docutils literal notranslate"><span class="pre">12</span></code> and
one on the stack.</p>
<p>The following value types can be entered:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Unsigned</span> <span class="pre">integral</span></code></dt><dd><p>A positive value in the selected base.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Signed</span> <span class="pre">integral</span></code></dt><dd><p>A positive or negative value in base 10. This value needs to be prefixed with
an <code class="docutils literal notranslate"><span class="pre">i</span></code> in the input. Its main use-case is to allow the two’s complement of
signed integers.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Floating</span> <span class="pre">point</span></code></dt><dd><p>An positive floating point value. The exponent can have a negative value.</p>
</dd>
</dl>
</section>
<section id="operations">
<h3><a class="toc-backref" href="#id9">Operations</a><a class="headerlink" href="#operations" title="Permalink to this headline">¶</a></h3>
<p>Most operations will require one or two stack elements. The basic operation is:</p>
<ul class="simple">
<li><p>take an element from the stack <code class="docutils literal notranslate"><span class="pre">arg</span> <span class="pre">1</span></code>,</p></li>
<li><p>take an element from the stack <code class="docutils literal notranslate"><span class="pre">arg</span> <span class="pre">2</span></code>,</p></li>
<li><p>execute the requested postfix operation,</p></li>
<li><p>push the result of the operation on the stack.</p></li>
</ul>
<p>To do a simple addition like <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">+</span> <span class="pre">2</span></code> would be one of the following options:</p>
<ul class="simple">
<li><p>Type <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">2+</span></code></p></li>
<li><p>Type <code class="docutils literal notranslate"><span class="pre">1</span></code> press <code class="docutils literal notranslate"><span class="pre">return</span></code> type <code class="docutils literal notranslate"><span class="pre">2</span></code> type <code class="docutils literal notranslate"><span class="pre">+</span></code>.</p></li>
<li><p>Type <code class="docutils literal notranslate"><span class="pre">1</span></code> press <code class="docutils literal notranslate"><span class="pre">return</span></code> type <code class="docutils literal notranslate"><span class="pre">2</span></code> press <code class="docutils literal notranslate"><span class="pre">return</span></code> type <code class="docutils literal notranslate"><span class="pre">+</span></code>.</p></li>
</ul>
<p>This is a short summary of the operations, but behind the scenes the
<a class="reference external" href="calculation.html">calculations</a> have more complexity.</p>
<ul>
<li><p>Arithmetic:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">+</span></code></dt><dd><p>Adds two elements on the stack.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-</span></code></dt><dd><p>Subtracts two elements on the stack. This can’t be used for negative
values. Entering negative values is done with <code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">n</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">*</span></code></dt><dd><p>Multiplies two elements on the stack.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">/</span></code></dt><dd><p>Divides two elements on the stack.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">n</span></code></dt><dd><p>Negates one element on the stack. This is the way to get negative values.</p>
</dd>
</dl>
</li>
<li><p>Bitwise:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">&amp;</span></code></dt><dd><p>Calculates the bitwise and of two elements on the stack.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">|</span></code></dt><dd><p>Calculates the bitwise or of two elements on the stack.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">^</span></code></dt><dd><p>Calculates the bitwise xor of two elements on the stack.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">~</span></code></dt><dd><p>Calculates the bitwise complement of one element on the stack.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&lt;</span></code></dt><dd><p>Calculates the bitwise shift left of one element on the stack.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&gt;</span></code></dt><dd><p>Calculates the bitwise shift right of one element on the stack.</p>
</dd>
</dl>
</li>
<li><p>Base:</p>
<p>The application allows the user to switch the base used to display values.
The based used for input and output are separate.</p>
<ul>
<li><p>Input:</p>
<ul class="simple">
<li><p>Binary (base 2), prefix the input with <code class="docutils literal notranslate"><span class="pre">0b</span></code>.</p></li>
<li><p>Octal (base 8), prefix the input with <code class="docutils literal notranslate"><span class="pre">0</span></code>. A single <code class="docutils literal notranslate"><span class="pre">0</span></code> is considered
a decimal zero. But since zero is identical in all bases that’s not an
issue.</p></li>
<li><p>Decimal (base 10), this is the default and requires no prefix.</p></li>
<li><p>Hexadecimal (base 16), prefix the input with <code class="docutils literal notranslate"><span class="pre">0x</span></code>. All hexadecimal
characters should be lowercase.</p></li>
</ul>
</li>
<li><p>Output:</p>
<p>By default the output is decimal. This can be changed. The change modifies
all elements on the stack. The input is unaffected.</p>
<ul class="simple">
<li><p>Binary (base 2), use <code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">b</span></code>.</p></li>
<li><p>Octal (base 8), use <code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">o</span></code>.</p></li>
<li><p>Decimal (base 10), use <code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">d</span></code>.</p></li>
<li><p>Hexadecimal (base 16), use <code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">h</span></code>.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">Ctrl</span></code> Toggles the usage of digit grouping in the output of integrals.</p>
</li>
</ul>
</li>
<li><p>Powers:</p>
<p><code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">&lt;x&gt;</span></code>
If <code class="docutils literal notranslate"><span class="pre">x</span></code> is in the range <code class="docutils literal notranslate"><span class="pre">[2,</span> <span class="pre">9]</span></code>, raises the value on the stack to the
power of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</li>
<li><p>Miscellaneous:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Backspace</span></code></dt><dd><p>As long as the input buffer isn’t empty it removes the last character from
the input buffer. When the input buffer is empty it discards on element
from the stack.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">z</span></code></dt><dd><p>Undo the last operation. This only affects the input buffer and the stack.
Multiple actions can be undo until reaching the initial state of the
application.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">Z</span></code></dt><dd><p>Redo the last undone operation. Multiple actions can be redone until</p>
<ul class="simple">
<li><p>reaching the final undo action,</p></li>
<li><p>doing a regular operation.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
<section id="constants">
<h3><a class="toc-backref" href="#id10">Constants</a><a class="headerlink" href="#constants" title="Permalink to this headline">¶</a></h3>
<p>Certain special textual values will store a numeric value on the stack:</p>
<ul class="simple">
<li><p>Signed integral minima:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">int8_min</span></code> pushes the minimum value of <code class="docutils literal notranslate"><span class="pre">int8_t</span></code> on the stack.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int16_min</span></code> pushes the minimum value of <code class="docutils literal notranslate"><span class="pre">int16_t</span></code> on the stack.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int32_min</span></code> pushes the minimum value of <code class="docutils literal notranslate"><span class="pre">int32_t</span></code> on the stack.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int64_min</span></code> pushes the minimum value of <code class="docutils literal notranslate"><span class="pre">int64_t</span></code> on the stack.</p></li>
</ul>
</li>
<li><p>Signed integral maxima:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">int8_max</span></code> pushes the maximum value of <code class="docutils literal notranslate"><span class="pre">int8_t</span></code> on the stack.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int16_max</span></code> pushes the maximum value of <code class="docutils literal notranslate"><span class="pre">int16_t</span></code> on the stack.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int32_max</span></code> pushes the maximum value of <code class="docutils literal notranslate"><span class="pre">int32_t</span></code> on the stack.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int64_max</span></code> pushes the maximum value of <code class="docutils literal notranslate"><span class="pre">int64_t</span></code> on the stack.</p></li>
</ul>
</li>
<li><p>Unsigned integral maxima <a class="footnote-reference brackets" href="#f1" id="id4">1</a>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">uint8_max</span></code> pushes the maximum value of <code class="docutils literal notranslate"><span class="pre">uint8_t</span></code> on the stack.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">uint16_max</span></code> pushes the maximum value of <code class="docutils literal notranslate"><span class="pre">uint16_t</span></code> on the stack.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">uint32_max</span></code> pushes the maximum value of <code class="docutils literal notranslate"><span class="pre">uint32_t</span></code> on the stack.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">uint64_max</span></code> pushes the maximum value of <code class="docutils literal notranslate"><span class="pre">uint64_t</span></code> on the stack.</p></li>
</ul>
</li>
<li><p>Floating point minima:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">float_min</span></code> pushes the smallest positive <code class="docutils literal notranslate"><span class="pre">float</span></code> on the stack.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">double_min</span></code> pushes the smallest positive <code class="docutils literal notranslate"><span class="pre">double</span></code> on the stack.</p></li>
</ul>
</li>
<li><p>Floating point maxima:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">float_max</span></code> pushes the largest positive <code class="docutils literal notranslate"><span class="pre">float</span></code> on the stack.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">double_max</span></code> pushes the largest positive <code class="docutils literal notranslate"><span class="pre">double</span></code> on the stack.</p></li>
</ul>
</li>
<li><p>Special constants:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> pushes the value of <code class="docutils literal notranslate"><span class="pre">e</span></code> as <code class="docutils literal notranslate"><span class="pre">double</span></code> on the stack.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pi</span></code> pushes the value of <code class="docutils literal notranslate"><span class="pre">pi</span></code> as <code class="docutils literal notranslate"><span class="pre">double</span></code> on the stack.</p></li>
</ul>
</li>
</ul>
<dl class="footnote brackets">
<dt class="label" id="f1"><span class="brackets"><a class="fn-backref" href="#id4">1</a></span></dt>
<dd><p>The minimum value of all unsigned integrals is <code class="docutils literal notranslate"><span class="pre">0</span></code> so they are not
available as a constant.</p>
</dd>
</dl>
</section>
<section id="functions">
<h3><a class="toc-backref" href="#id11">Functions</a><a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h3>
<p>Other special textual values will execute an operation. These commands are</p>
<ul class="simple">
<li><p>Rounding functions</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">round</span></code> rounds a <code class="docutils literal notranslate"><span class="pre">double</span></code> to its nearest integral representation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">floor</span></code> returns a <code class="docutils literal notranslate"><span class="pre">double</span></code> with an integral representation less than or
equal to the original value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ceil</span></code> returns a <code class="docutils literal notranslate"><span class="pre">double</span></code> with an integral representation greater than
or equal to the original value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trunc</span></code> returns a <code class="docutils literal notranslate"><span class="pre">double</span></code> with an integral representation where the
fractional part is truncated.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="known-limitations">
<h2><a class="toc-backref" href="#id12">Known limitations</a><a class="headerlink" href="#known-limitations" title="Permalink to this headline">¶</a></h2>
<section id="building-requires-a-git-build-of-clang-and-libc">
<h3><a class="toc-backref" href="#id13">Building requires a git build of Clang and libc++</a><a class="headerlink" href="#building-requires-a-git-build-of-clang-and-libc" title="Permalink to this headline">¶</a></h3>
<p>The goal of the application was to experiment with modules. Since module support
in various compilers is in various stages of development I want to focus on one
toolchain. Once modules becomes production quality in both compilers and CMake
other compiler might be supported.</p>
</section>
<section id="the-gui-isn-t-great">
<h3><a class="toc-backref" href="#id14">The GUI isn’t great</a><a class="headerlink" href="#the-gui-isn-t-great" title="Permalink to this headline">¶</a></h3>
<p>Basically the GUI is only used for output nothing else at the moment. The user
interaction is low on the priority list. The initial goal is to get something
usable for me.</p>
</section>
<section id="the-gui-is-inefficient">
<h3><a class="toc-backref" href="#id15">The GUI is inefficient</a><a class="headerlink" href="#the-gui-is-inefficient" title="Permalink to this headline">¶</a></h3>
<p>The application is quite happy to redraw too many elements. An attempt has been
made to improve this. An observer was created, however it seems that Clang
modules and vtables don’t play along nicely with the linker. These linker errors
prevented me from using this pattern. Since the application is fast enough this
improvement has dropped low on the priority list.</p>
</section>
</section>
<section id="links">
<h2><a class="toc-backref" href="#id16">Links</a><a class="headerlink" href="#links" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="calculation.html">Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>
</div>
<ul class="simple">
<li><p><a class="reference external" href="coverage/index.html">Coverage report</a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="footnote brackets">
<dt class="label" id="note-cd"><span class="brackets"><a class="fn-backref" href="#id1">2</a></span></dt>
<dd><p>There’s a CD part too, but since the application isn’t in a
deployable state there’s no need to have a real CD part. Still this page is
deployed by Github actions.</p>
</dd>
</dl>
</div>
</section>
</section>


          </div>
          
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Mark de Wever.
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>