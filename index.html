
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>RPN Calculator &#8212; RPN 0.3.0-dev documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Calculations" href="calculation.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="rpn-calculator">
<h1>RPN Calculator<a class="headerlink" href="#rpn-calculator" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#building" id="id4">Building</a></li>
<li><a class="reference internal" href="#usage" id="id5">Usage</a><ul>
<li><a class="reference internal" href="#gui" id="id6">GUI</a></li>
<li><a class="reference internal" href="#input-values" id="id7">Input values</a></li>
<li><a class="reference internal" href="#operations" id="id8">Operations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#known-limitations" id="id9">Known limitations</a><ul>
<li><a class="reference internal" href="#building-requires-a-git-build-of-clang-and-libc" id="id10">Building requires a git build of Clang and libc++</a></li>
<li><a class="reference internal" href="#the-gui-isn-t-great" id="id11">The GUI isn’t great</a></li>
<li><a class="reference internal" href="#the-gui-is-inefficient" id="id12">The GUI is inefficient</a></li>
</ul>
</li>
<li><a class="reference internal" href="#links" id="id13">Links</a></li>
</ul>
</div>
<p>This is yet another
<a class="reference external" href="https://en.wikipedia.org/wiki/Reverse_Polish_notation">RPN</a> calculator. It’s
still in its infancy and the goal of the application is to have better support
for different bases and make it easy to use bitwise operations.</p>
<p>Next to its practical usage the application is used to experiment with:</p>
<blockquote>
<div><ul class="simple">
<li>The latest C++ features available in <a class="reference external" href="clang.llvm.org/">Clang</a> and
<a class="reference external" href="libcxx.llvm.org/">libc++</a>.</li>
<li>The possible CI <a class="footnote-reference" href="#note-cd" id="id1">[1]</a> features of GitHub actions.</li>
</ul>
</div></blockquote>
<p>The sources of the project are at <a class="reference external" href="https://github.com/mordante/rpn">GitHub</a>.</p>
<div class="section" id="building">
<h2><a class="toc-backref" href="#id4">Building</a><a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h2>
<p>In order to build the application the following dependencies are required:</p>
<ul class="simple">
<li><a class="reference external" href="https://cmake.org/">CMake</a> 3.13.0 or later. Once CMake adds proper module
support the requirement will be incremented to that version.</li>
<li>A recent <a class="reference external" href="clang.llvm.org/">Clang</a> main build. Clang 13.0.0 is expected to
work, but when module support improves on Clang a more recent build will be
required.</li>
<li>A recent <a class="reference external" href="libcxx.llvm.org/">libc++</a> main build. In libc++ both <code class="docutils literal notranslate"><span class="pre">&lt;ranges&gt;</span></code>
and <code class="docutils literal notranslate"><span class="pre">&lt;format&gt;</span></code> are actively being developed. When features land in the main
branch the application will use some of these features.</li>
<li>A working Internet connection. The application depends on
<a class="reference external" href="http://google.github.io/googletest/">GoogleTest</a> and
<a class="reference external" href="https://cmake.org/">FLTK</a>. The proper dependencies are downloaded during
the build process.</li>
<li>Optional when enabling coverage <code class="docutils literal notranslate"><span class="pre">llvm-cov</span></code> and <code class="docutils literal notranslate"><span class="pre">llvm-profdata</span></code> are
required. This should be the same version as Clang, but normally they are
installed together with Clang.</li>
</ul>
<p>The build itself is a normal CMake build. It has the following options:</p>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id5">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="section" id="gui">
<h3><a class="toc-backref" href="#id6">GUI</a><a class="headerlink" href="#gui" title="Permalink to this headline">¶</a></h3>
<p>The application has a simple GUI with the following elements:</p>
<dl class="docutils">
<dt>Diagnostics</dt>
<dd>Contains the diagnostics issued by the application. Usually an error message
regarding the last operation.</dd>
<dt>Stack</dt>
<dd>The stack with the values to operate on.</dd>
<dt>Input</dt>
<dd>The input buffer where new text is entered.</dd>
</dl>
<p>At the moment the GUI has no real interaction with the user and can’t be
controlled. All keyboard input is automatically processed by the input buffer.</p>
</div>
<div class="section" id="input-values">
<h3><a class="toc-backref" href="#id7">Input values</a><a class="headerlink" href="#input-values" title="Permalink to this headline">¶</a></h3>
<p>Numbers can be entered in the input buffer and put on the stack. A number will
be put on the stack directly when pressing enter. Most operations that work on
stack entries will first put the value of the input buffer on the stack before
applying their operations.</p>
<p>A numeric value may use a digit group separator to improve readability. The
allowed separators are <code class="docutils literal notranslate"><span class="pre">_</span></code> and <code class="docutils literal notranslate"><span class="pre">,`</span></code>.</p>
<p>For example: <code class="docutils literal notranslate"><span class="pre">1_2</span> <span class="pre">1</span></code> and pressing <code class="docutils literal notranslate"><span class="pre">return</span></code> will put the values <code class="docutils literal notranslate"><span class="pre">12</span></code> and
one on the stack.</p>
<p>The following value types can be entered:</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Unsigned</span> <span class="pre">integral</span></code></dt>
<dd>A positive value in the selected base.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Signed</span> <span class="pre">integral</span></code></dt>
<dd>A positive or negative value in base 10. This value needs to be prefixed with
an <code class="docutils literal notranslate"><span class="pre">i</span></code> in the input. Its main use-case is to allow the two’s complement of
signed integers.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Floating</span> <span class="pre">point</span></code></dt>
<dd>An positive floating point value. The exponent can have a negative value.</dd>
</dl>
</div>
<div class="section" id="operations">
<h3><a class="toc-backref" href="#id8">Operations</a><a class="headerlink" href="#operations" title="Permalink to this headline">¶</a></h3>
<p>Most operations will require one or two stack elements. The basic operation is:</p>
<ul class="simple">
<li>take an element from the stack <code class="docutils literal notranslate"><span class="pre">arg</span> <span class="pre">1</span></code>,</li>
<li>take an element from the stack <code class="docutils literal notranslate"><span class="pre">arg</span> <span class="pre">2</span></code>,</li>
<li>execute the requested postfix operation,</li>
<li>push the result of the operation on the stack.</li>
</ul>
<p>To do a simple addition like <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">+</span> <span class="pre">2</span></code> would be one of the following options:</p>
<ul class="simple">
<li>Type <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">2+</span></code></li>
<li>Type <code class="docutils literal notranslate"><span class="pre">1</span></code> press <code class="docutils literal notranslate"><span class="pre">return</span></code> type <code class="docutils literal notranslate"><span class="pre">2</span></code> type <code class="docutils literal notranslate"><span class="pre">+</span></code>.</li>
<li>Type <code class="docutils literal notranslate"><span class="pre">1</span></code> press <code class="docutils literal notranslate"><span class="pre">return</span></code> type <code class="docutils literal notranslate"><span class="pre">2</span></code> press <code class="docutils literal notranslate"><span class="pre">return</span></code> type <code class="docutils literal notranslate"><span class="pre">+</span></code>.</li>
</ul>
<p>This is a short summary of the operations, but behind the scenes the
<a class="reference external" href="calculation.html">calculations</a> have more complexity.</p>
<ul>
<li><p class="first">Arithmetic:</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">+</span></code></dt>
<dd><p class="first last">Adds two elements on the stack.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-</span></code></dt>
<dd><p class="first last">Subtracts two elements on the stack. This can’t be used for negative
values. Entering negative values is done with <code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">n</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">*</span></code></dt>
<dd><p class="first last">Multiplies two elements on the stack.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">/</span></code></dt>
<dd><p class="first last">Divides two elements on the stack.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">n</span></code></dt>
<dd><p class="first last">Negates one element on the stack. This is the way to get negative values.</p>
</dd>
</dl>
</li>
<li><p class="first">Bitwise:</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">&amp;</span></code></dt>
<dd><p class="first last">Calculates the bitwise and of two elements on the stack.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">|</span></code></dt>
<dd><p class="first last">Calculates the bitwise or of two elements on the stack.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">^</span></code></dt>
<dd><p class="first last">Calculates the bitwise xor of two elements on the stack.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">~</span></code></dt>
<dd><p class="first last">Calculates the bitwise complement of one element on the stack.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&lt;</span></code></dt>
<dd><p class="first last">Calculates the bitwise shift left of one element on the stack.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&gt;</span></code></dt>
<dd><p class="first last">Calculates the bitwise shift right of one element on the stack.</p>
</dd>
</dl>
</li>
<li><p class="first">Base:</p>
<p>The application allows the user to switch the base used to display values.
The based used for input and output are separate.</p>
<ul>
<li><p class="first">Input:</p>
<ul class="simple">
<li>Binary (base 2), prefix the input with <code class="docutils literal notranslate"><span class="pre">0b</span></code>.</li>
<li>Octal (base 8), prefix the input with <code class="docutils literal notranslate"><span class="pre">0</span></code>. A single <code class="docutils literal notranslate"><span class="pre">0</span></code> is considered
a decimal zero. But since zero is identical in all bases that’s not an
issue.</li>
<li>Decimal (base 10), this is the default and requires no prefix.</li>
<li>Hexadecimal (base 16), prefix the input with <code class="docutils literal notranslate"><span class="pre">0x</span></code>. All hexadecimal
characters should be lowercase.</li>
</ul>
</li>
<li><p class="first">Output:</p>
<p>By default the output is decimal. This can be changed. The change modifies
all elements on the stack. The input is unaffected.</p>
<ul class="simple">
<li>Binary (base 2), use <code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">b</span></code>.</li>
<li>Octal (base 8), use <code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">o</span></code>.</li>
<li>Decimal (base 10), use <code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">d</span></code>.</li>
<li>Hexadecimal (base 16), use <code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">h</span></code>.</li>
</ul>
</li>
</ul>
</li>
<li><p class="first">Miscellaneous:</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">Backspace</span></code></dt>
<dd><p class="first last">As long as the input buffer isn’t empty it removes the last character from
the input buffer. When the input buffer is empty it discards on element
from the stack.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">z</span></code></dt>
<dd><p class="first last">Undo the last operation. This only affects the input buffer and the stack.
Multiple actions can be undo until reaching the initial state of the
application.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">Z</span></code></dt>
<dd><p class="first">Redo the last undone operation. Multiple actions can be redone until</p>
<ul class="last simple">
<li>reaching the final undo action,</li>
<li>doing a regular operation.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
</div>
<div class="section" id="known-limitations">
<h2><a class="toc-backref" href="#id9">Known limitations</a><a class="headerlink" href="#known-limitations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="building-requires-a-git-build-of-clang-and-libc">
<h3><a class="toc-backref" href="#id10">Building requires a git build of Clang and libc++</a><a class="headerlink" href="#building-requires-a-git-build-of-clang-and-libc" title="Permalink to this headline">¶</a></h3>
<p>The goal of the application was to experiment with modules. Since module support
in various compilers is in various stages of development I want to focus on one
toolchain. Once modules becomes production quality in both compilers and CMake
other compiler might be supported.</p>
</div>
<div class="section" id="the-gui-isn-t-great">
<h3><a class="toc-backref" href="#id11">The GUI isn’t great</a><a class="headerlink" href="#the-gui-isn-t-great" title="Permalink to this headline">¶</a></h3>
<p>Basically the GUI is only used for output nothing else at the moment. The user
interaction is low on the priority list. The initial goal is to get something
usable for me.</p>
</div>
<div class="section" id="the-gui-is-inefficient">
<h3><a class="toc-backref" href="#id12">The GUI is inefficient</a><a class="headerlink" href="#the-gui-is-inefficient" title="Permalink to this headline">¶</a></h3>
<p>The application is quite happy to redraw too many elements. An attempt has been
made to improve this. An observer was created, however it seems that Clang
modules and vtables don’t play along nicely with the linker. These linker errors
prevented me from using this pattern. Since the application is fast enough this
improvement has dropped low on the priority list.</p>
</div>
</div>
<div class="section" id="links">
<h2><a class="toc-backref" href="#id13">Links</a><a class="headerlink" href="#links" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="calculation.html">Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>
</div>
<ul class="simple">
<li><a class="reference external" href="coverage/index.html">Coverage report</a></li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<table class="last docutils footnote" frame="void" id="note-cd" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>There’s a CD part too, but since the application isn’t in a
deployable state there’s no need to have a real CD part. Still this page is
deployed by Github actions.</td></tr>
</tbody>
</table>
</div>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Mark de Wever.
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>